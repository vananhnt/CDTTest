<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>CHANGEVAR operator</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- 3,html --> 
<meta name="src" content="manual.tex"> 
<link rel="stylesheet" type="text/css" href="manual.css"> 
</head><body 
>
<p align="centre"><img src="redlogo.png" width=621 height=60 border=0 alt="REDUCE"></p><table cellspacing="5"><tr><td class="clinks"><a 
href="manualch7.html#manualse32.html" >Up</a></td><td class="clinks"><a 
href="manualse33.html" >Next</a></td><td class="clinks"><a 
href="manualse31.html" >Prev</a></td><td class="clinks"><a 
href="manualse31.html#tailmanualse31.html" >PrevTail</a></td><td class="clinks"><a 
href="#tailmanualse32.html">Tail</a></td></tr></table><h3 class="sectionHead"><span class="titlemark">7.6    </span> <a 
 id="x43-730007.6"></a>CHANGEVAR operator</h3>
<!--l. 563--><p class="noindent" ><a 
 id="operator:CHANGEVAR"></a> <a 
 id="dx43-73001"></a>
<!--l. 566--><p class="noindent" >Author: G. Üçoluk.
<!--l. 569--><p class="noindent" >The operator <span 
class="pcrr8t-x-x-109">CHANGEVAR </span>does a variable transformation in a set of differential
equations. Syntax:
  <div class="syntax">
  <div class="array"> <table id="TBL-12" class="array" 
cellpadding="0" cellspacing="0"  
><colgroup id="TBL-12-1g"><col 
id="TBL-12-1"><col 
id="TBL-12-2"><col 
id="TBL-12-3"></colgroup><tr  
 style="vertical-align:baseline;"><td  style="white-space:nowrap; text-align:left;" 
><div class="td11"><span 
class="pcrr8t-x-x-109">changevar(</span><span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">depvars</span><span 
class="cmsy-10x-x-109">&#x27E9;</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">newvars</span><span 
class="cmsy-10x-x-109">&#x27E9;</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">eqlist</span><span 
class="cmsy-10x-x-109">&#x27E9;</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">diffeq</span><span 
class="cmsy-10x-x-109">&#x27E9;</span><span 
class="pcrr8t-x-x-109">)</span></div></td></tr></table>                </div></div>
<!--l. 575--><p class="noindent" ><span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">diffeq</span><span 
class="cmsy-10x-x-109">&#x27E9;</span> is either a single differential equation or a list of differential equations, <span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">depvars</span><span 
class="cmsy-10x-x-109">&#x27E9;</span>
are the dependent variables to be substituted, <span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">newvars</span><span 
class="cmsy-10x-x-109">&#x27E9;</span> are the new depend variables,
and <span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">eqlist</span><span 
class="cmsy-10x-x-109">&#x27E9;</span> is a list of equations of the form <span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">depvar</span><span 
class="cmsy-10x-x-109">&#x27E9;</span><span 
class="pcrr8t-x-x-109">=</span><span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">expression</span><span 
class="cmsy-10x-x-109">&#x27E9;</span> where <span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">expression</span><span 
class="cmsy-10x-x-109">&#x27E9;</span>
is some function in the new dependent variables.
<!--l. 582--><p class="noindent" >The three lists <span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">depvars</span><span 
class="cmsy-10x-x-109">&#x27E9;</span>, <span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">newvars</span><span 
class="cmsy-10x-x-109">&#x27E9;</span>, and <span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="ptmri8t-x-x-109">eqlist</span><span 
class="cmsy-10x-x-109">&#x27E9;</span> must be of the same length. If there is
only one variable to be substituted, then it can be given instead of the list. The same
applies to the list of differential equations, i.e., the following two commands are
equivalent
                                                                     

                                                                     
<div class="verbatim" id="verbatim-108">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;changevar(u,y,x=e^y,df(u(x),x)&#x00A0;-&#x00A0;log(x));
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;changevar({u},{y},{x=e^y},{df(u(x),x)&#x00A0;-&#x00A0;log(x)});
</div>
<!--l. 591--><p class="nopar" > except for one difference: the first command returns the transformed differential
equation, the second one a list with a single element.
<!--l. 595--><p class="noindent" ><a 
 id="switch:DISPJACOBIAN"></a> The switch <span 
class="pcrr8t-x-x-109">DISPJACOBIAN </span>governs the display the entries of the inverse Jacobian, it
is <span 
class="pcrr8t-x-x-109">OFF </span>per default.<a 
 id="dx43-73002"></a><a 
 id="dx43-73003"></a><a 
 id="dx43-73004"></a>
<!--l. 599--><p class="noindent" >The mathematics behind the change of independent variable(s) in differential equations is
quite straightforward. It is basically the application of the chain rule. If the dependent
variable of the differential equation is <span 
class="cmmi-10x-x-109">F </span>, the independent variables are <span 
class="cmmi-10x-x-109">x</span><sub><span 
class="cmmi-8">i</span></sub> and
the new independent variables are <span 
class="cmmi-10x-x-109">u</span><sub><span 
class="cmmi-8">i</span></sub> (where <span 
class="cmmi-8">i</span><span 
class="cmr-8">=1</span><span 
class="cmmi-8">&#x2026;</span><span 
class="cmmi-8">n</span>) then the first derivatives
are:
<center class="math-display" >
<img 
src="manual6x.png" alt="-&#x2202;F-=  &#x2202;F-&#x2202;uj-
&#x2202;xi    &#x2202;uj &#x2202;xi
" class="math-display" ></center>
<!--l. 607--><p class="nopar" > We assumed Einstein&#8217;s summation convention. Here the problem is to calculate the
<span 
class="cmmi-10x-x-109">&#x2202;u</span><sub><span 
class="cmmi-8">j</span></sub><span 
class="cmmi-10x-x-109">&#x2215;&#x2202;x</span><sub><span 
class="cmmi-8">i</span></sub> terms if the change of variables is given by
<center class="math-display" >
<img 
src="manual7x.png" alt="x = f (u ,...,u  )
 i   i  1      n
" class="math-display" ></center>
<!--l. 613--><p class="nopar" > The first thought might be solving the above given equations for <span 
class="cmmi-10x-x-109">u</span><sub><span 
class="cmmi-8">j</span></sub> and then
differentiating them with respect to <span 
class="cmmi-10x-x-109">x</span><sub><span 
class="cmmi-8">i</span></sub>, then again making use of the equations above,
substituting new variables for the old ones in the calculated derivatives. This is not
always a preferable way to proceed. Mainly because the functions <span 
class="cmmi-10x-x-109">f</span><sub><span 
class="cmmi-8">i</span></sub> may not always be
easily invertible. Another approach that makes use of the Jacobian is better. Consider the
above given equations which relate the old variables to the new ones. Let us differentiate
them:
                                                                     

                                                                     
<table 
class="align-star">
                           <tr><td 
class="align-odd"><img 
src="manual8x.png" alt="&#x2202;xj-
&#x2202;xi"  class="frac" align="middle"></td>                           <td 
class="align-even"> <span 
class="cmr-10x-x-109">=</span> <img 
src="manual9x.png" alt="&#x2202;fj-
&#x2202;xi"  class="frac" align="middle"></td>                               <td 
class="align-label"></td>                           <td 
class="align-label">
                           </td></tr><tr><td 
class="align-odd"><span 
class="cmmi-10x-x-109">&#x03B4;</span><sub><span 
class="cmmi-8">ij</span></sub></td>                             <td 
class="align-even"> <span 
class="cmr-10x-x-109">=</span> <img 
src="manual10x.png" alt="-&#x2202;fj
&#x2202;uk"  class="frac" align="middle"><img 
src="manual11x.png" alt="&#x2202;uk-
&#x2202;xi"  class="frac" align="middle"></td>                           <td 
class="align-label"></td>                           <td 
class="align-label"></td></tr></table>
<!--l. 628--><p class="noindent" >The first derivative is nothing but the <span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">j,k</span><span 
class="cmr-10x-x-109">) </span>th entry of the Jacobian matrix.
<!--l. 630--><p class="noindent" >So if we speak in matrix language
<center class="math-display" >
<img 
src="manual12x.png" alt="1 = J &#x22C5; D
" class="math-display" ></center>
<!--l. 631--><p class="nopar" > where we defined the Jacobian
<center class="math-display" >
<img 
src="manual13x.png" alt="J  &#x25B3;= &#x2202;fi-
 ij   &#x2202;uj
" class="math-display" ></center>
<!--l. 633--><p class="nopar" > and the matrix of the derivatives we wanted to obtain as
<center class="math-display" >
<img 
src="manual14x.png" alt="    &#x25B3; &#x2202;ui
Dij = &#x2202;x--.
         j
" class="math-display" ></center>
<!--l. 635--><p class="nopar" > If the Jacobian has a non-vanishing determinant then it is invertible and we are able to
write from the matrix equation above:
<center class="math-display" >
<img 
src="manual15x.png" alt="D =  J-1
" class="math-display" ></center>
                                                                     

                                                                     
<!--l. 638--><p class="nopar" > so finally we have what we want
<center class="math-display" >
<img 
src="manual16x.png" alt="&#x2202;ui-  [ -1]
&#x2202;xj =  J   ij
" class="math-display" ></center>
<!--l. 642--><p class="nopar" > The higher derivatives are obtained by the successive application of the chain rule and
using the definitions of the old variables in terms of the new ones. It can be easily
verified that the only derivatives that are needed to be calculated are the first order ones
which are obtained above.
<!--l. 648--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.6.1    </span> <a 
 id="x43-740007.6.1"></a><span 
class="pcrr8t-x-x-109">CHANGEVAR </span>example: The 2-dim. Laplace Equation</h4>
<!--l. 649--><p class="noindent" >The 2-dimensional Laplace equation in cartesian coordinates is:
<center class="math-display" >
<img 
src="manual17x.png" alt="&#x2202;2u-+  &#x2202;2u-= 0
&#x2202;x2    &#x2202;y2
" class="math-display" ></center>
<!--l. 653--><p class="nopar" > Now assume we want to obtain the polar coordinate form of Laplace equation. The
change of variables is:
<center class="math-display" >
<img 
src="manual18x.png" alt="x = rcos &#x03B8;,    y = rsin &#x03B8;
" class="math-display" ></center>
<!--l. 658--><p class="nopar" > The solution using <span 
class="pcrr8t-x-x-109">CHANGEVAR </span>is as follows
                                                                     

                                                                     
<div class="verbatim" id="verbatim-109">
&#x00A0;&#x00A0;changevar({u},{r,theta},{x=r*cos&#x00A0;theta,y=r*sin&#x00A0;theta},
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{df(u(x,y),x,2)+df(u(x,y),y,2)}&#x00A0;);
</div>
<!--l. 663--><p class="nopar" > Here we could omit the curly braces in the first and last arguments (because those lists
have only one member) and the curly braces in the third argument (because they are
optional), but you cannot leave off the curly braces in the second argument. So one could
equivalently write
                                                                     

                                                                     
<div class="verbatim" id="verbatim-110">
&#x00A0;&#x00A0;&#x00A0;changevar(u,{r,theta},x=r*cos&#x00A0;theta,y=r*sin&#x00A0;theta,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;df(u(x,y),x,2)+df(u(x,y),y,2)&#x00A0;);
</div>
<!--l. 671--><p class="nopar" > If you have tried out the above example, you will notice that the denominator contains a
<span 
class="cmr-10x-x-109">cos</span><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmi-10x-x-109">&#x03B8; </span><span 
class="cmr-10x-x-109">+</span> <span 
class="cmr-10x-x-109">sin</span><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmi-10x-x-109">&#x03B8; </span>which is actually equal to <span 
class="cmr-10x-x-109">1</span>. This has of course nothing to do
with <span 
class="pcrr8t-x-x-109">CHANGEVAR</span>. One has to be overcome these pattern matching problems
by the conventional methods REDUCE provides (a rule, for example, will fix
it).
<!--l. 679--><p class="noindent" >Secondly you will notice that your <span 
class="pcrr8t-x-x-109">u(x,y) </span>operator has changed to <span 
class="pcrr8t-x-x-109">u(r,theta) </span>in
the result. Nothing magical about this. That is just what we do with pencil and paper.
<span 
class="pcrr8t-x-x-109">u(r,theta) </span>represents the the transformed dependent variable.
<!--l. 684--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.6.2    </span> <a 
 id="x43-750007.6.2"></a>Another <span 
class="pcrr8t-x-x-109">CHANGEVAR </span>example: An Euler Equation</h4>
<!--l. 685--><p class="noindent" >Consider a differential equation which is of Euler type, for instance:
<center class="math-display" >
<img 
src="manual19x.png" alt="x3y &#x2032;&#x2032;&#x2032; - 3x2y&#x2032;&#x2032; + 6xy &#x2032; - 6y = 0
" class="math-display" ></center>
<!--l. 688--><p class="nopar" > where prime denotes differentiation with respect to <span 
class="cmmi-10x-x-109">x</span>. As is well known, Euler type of
equations are solved by a change of variable:
<center class="math-display" >
<img 
src="manual20x.png" alt="     u
x = e
" class="math-display" ></center>
<!--l. 693--><p class="nopar" > So our call to <span 
class="pcrr8t-x-x-109">CHANGEVAR </span>reads as follows:
                                                                     

                                                                     
<div class="verbatim" id="verbatim-111">
&#x00A0;&#x00A0;&#x00A0;changevar(y,&#x00A0;u,&#x00A0;x=e**u,&#x00A0;x**3*df(y(x),x,3)-
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3*x**2*df(y(x),x,2)+6*x*df(y(x),x)-6*y(x));
</div>
<!--l. 698--><p class="nopar" > and returns the result
                                                                     

                                                                     
<div class="verbatim" id="verbatim-112">
&#x00A0;&#x00A0;&#x00A0;df(y(u),u,3)&#x00A0;-&#x00A0;6*df(y(u),u,2)&#x00A0;+&#x00A0;11*df(y(u),u)&#x00A0;-&#x00A0;6*y(u)
</div>
<!--l. 702--><p class="nopar" >
                                                                     

                                                                     
<!--l. 706--><p class="noindent" ><table cellspacing="5"><tr><td class="clinks"><a 
href="manualch7.html#manualse32.html" >Up</a></td><td class="clinks"><a 
href="manualse33.html" >Next</a></td><td class="clinks"><a 
href="manualse31.html" >Prev</a></td><td class="clinks"><a 
href="manualse31.html#tailmanualse31.html" >PrevTail</a></td><td class="clinks"><a 
href="manualse32.html" >Front</a></td></tr></table><a 
 id="tailmanualse32.html"></a>   
</body></html> 
